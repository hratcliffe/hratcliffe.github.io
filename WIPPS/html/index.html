<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>WIPPS: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="Doxy.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">WIPPS
   </div>
   <div id="projectbrief">Whistler-mode Interaction Post-Processing Suite</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Introduction"></a>
Introduction</h1>
<p>This program post-processes EPOCH PIC code output files to explore Whistler wave-particle interactions. It can create wave spectra, and calculate theory based growth rates and particle diffusion coefficients.</p>
<p>Function is divided across a set of utilities. <code>make list_utils</code> will list their names and each has an entry in <a class="el" href="group__utils.html">Available programs</a>. For example, generate_ffts processes input data and outputs trimmed FFTs, or calculate_growth calculates theoretical growth rates of whistlers.</p>
<p>The <a href="modules.html">Modules</a> tab  shows the various parts of the code. Broadly, we have classes to store data, access data from files, represent physical entities such as plasma, and non-thermal electrons, and perform required calculations, and collections of helpers for common actions.</p>
<h2><a class="anchor" id="setup"></a>
Code Setup</h2>
<p>Setup and use of the code is via a combination of config files and command line arguments. These specify the domain, working directory etc. For each program, help on the command line arguments is available with <code>name -h</code> Larger pieces of configuration are read from files. We use the deck.status file generated by EPOCH for user defined constants, a plasma.conf file for background plasma configuration and a non-thermal.conf file for non-thermal electron distributions (required for growth rate calculations). Examples of all the conf files are in the files subdirectory.</p>
<p>Some of the programs can use multiple cores, by parallelising over space.</p>
<h2><a class="anchor" id="Data"></a>
Arrays</h2>
<p>Data arrays are a specialised class containing data, axes and information. Get/set_element methods are provided for accessing specific parts. Spectrum and <a class="el" href="classdiffusion__coeff.html" title="Diffusion coefficient object. ">diffusion_coeff</a>'s are specialised data arrays representing physical entities. </p>
<h2><a class="anchor" id="FileIO"></a>
SDF IO</h2>
<p>SDF file reading uses the SDF C libraries. A copy of these is provided with the code, and an installer script install given to build them. </p>
<h2><a class="anchor" id="FFT"></a>
Fourier Transforms and Special Functions</h2>
<p>FFTs are handled by the FFTW routines in suitable precision (float or double). Special functions are provided by Boost. </p>
<h2><a class="anchor" id="contr"></a>
Spectrum and D generation</h2>
<p>Some objects are deeply connected. In particular, spectrums are connected to plasmas, and diffusion_coeffs are deeply connected to spectrums. Keeping these connected is the job on the controller class, which creates and stores them.</p>
<h1><a class="anchor" id="prereqs"></a>
Prerequisites</h1>
<p>As well as the code, an install of boost is needed (exists on OSX and most Linux systems) as well as the correct version of FFTW libraries (float for float data, double for double). A copy of EPOCH's SDF file library is included with the code. To generate the docs Doxygen and pdftex are used. See <a class="el" href="index.html#build">Building the Code</a> for information on how to build prereqs.</p>
<h1><a class="anchor" id="docs"></a>
This Documentation</h1>
<p>These docs describe all classes and methods under the <a href="annotated.html">Classes</a>  section. Helper functions, constants etc are grouped under <a href="modules.html">Modules</a>. Assumptions and caveats within the code are collected under <a class="el" href="caveats.html">Caveats and Assumptions</a>.</p>
<p>Full and User docs are available. The former includes all private entities, function references, and a full source code listing. The latter does not. Change between these modes with <code>make DOCS=full</code> and <code>make DOCS=user</code></p>
<h1><a class="anchor" id="build"></a>
Building the Code</h1>
<p>An install script is provided to build SDF, install fftw etc. For details run <code>./install --help</code> Build using make. If input data is type double, use <code>make TYPE=double</code> to build with correct FFT etc libraries.</p>
<p>Once the code has been built, <code>make tar_built</code> to produce a tarball Runnable.tgz of utilities and necessary files that can be copied elsewhere and run. </p>
<h1><a class="anchor" id="idl"></a>
IDL routines</h1>
<p>Some IDL helpers are provided for reading the output files, reading the deck.status file etc. The simple way to use these is to copy the enclosed .idlstartup file to the directory you run analysis from and set this as a startup file like, for example, <code>pref_set, "IDL_STARTUP", "/path/to/.idlstartup",/commit</code> Then set a <code>WIPPS_PATH</code> environment variable giving the location of the wipps code. Start idl, and you should see a series of "% Compiled module:" lines. Try <code>IDL&gt; v_to_kev(0.5) 79.051798621061963</code> to test</p>
<h1><a class="anchor" id="mod"></a>
Modifying the Code</h1>
<p>Any changes to code include files or addition of files will change dependencies. In this case run <code>make echo_deps</code> before a clean build to regenerate the makefile listing of included headers.</p>
<p>test, profile and debug modes are also available, and are invoked with <code>make MODE=[test,profile,debug]</code> after a clean. More details on testing are below.</p>
<p>See the <a class="el" href="todo.html">Todo List</a> and <a class="el" href="exts.html">Extensions to Consider</a> pages for tasks and extensions. </p>
<h2><a class="anchor" id="Versioning"></a>
Versioning</h2>
<p>Version numbers follow the usual major-minor numbering. So in general any change to file-io, data normalisation etc which may break compatibility should bump the major number, and any substantive change to how things are done bumps the minor. For example, adding a new field to data files, or changing the FFT normalisation by 2!pi is a major change. Tweaking spectrum extraction to be different but equally correct is a minor. Internal-only changes change neither number.</p>
<p>Version number is derived using a git tag, so to set one do something like <code>git tag -a vx.y -m "Messsage here"</code> before commit and make sure to push tags</p>
<p>Generally only some utilities will be broken by changes, so we don't necessarily quit on mismatch. It's probably easiest to write a small file-converter to update old files and solve errors that way. </p>
<h1><a class="anchor" id="test"></a>
Integrated Testing</h1>
<p>All significant parts of the code should be covered by inbuilt tests. These are defined in tests.cpp, tests_basic_and_code.cpp and tests_data_and_calc.cpp and cover a mixture of unit testing, science testing and library integration tests. To run the tests, clean build with <code>make clean &amp;&amp; make MODE=test</code> and run <code>./main</code>. Errors and outcomes are written to stderr, information to stdout. Thus <code>./main 1&gt; /dev/null</code> will show only the former, etc. A logfile is produced, by default named tests.log. Temporary testing files are written into tests::tests_tmp_dir. Some tests are rather heavy so are only run if flags are set. See tests in the Test Docs for these. By default, all compiles are at optimisation O3. To compile with O0 for testing or debugging, pass NO_OPT = 1 to the make command.</p>
<p>Consider adding tests for any significant additions or changes, and running the existing ones in this case. To include tests in this documentation, run <code>make MODE=test docs</code>. Similarly, to omit them, make without test mode.</p>
<h1><a class="anchor" id="cpp"></a>
Minimally wrong description of C++ as used here</h1>
<h2><a class="anchor" id="types"></a>
Types and typedefs</h2>
<p>There's two ways to do a character string, old C-style array or characters, or a std::string (see below for meaning of std::). Some older functions expect the former, so the .c_str() conversion is used. I use C-strings for some things to match the libraries being used. The special type size_t is defined as an unsigned integer type large enough to count "anything". Unsigned so cannot be negative, but is used for counts, sizes etc. I have also added a typedef for the type in the data files and that to do the calculations in, my_type and calc_type respectively, defined in support.h. I decided to do all calculations as double, but as my data are float I use float versions of the FFTW libraries. </p>
<h2><a class="anchor" id="class"></a>
Classes</h2>
<p>For this code, classes are basically structs containing data, with special methods (member functions). These always know the contents of the class and can access bits that might be hidden from the outside (private or protected). One class can extend another, as <a class="el" href="classdata__array.html" title="Extended my_array class including axes. ">data_array</a> does to <a class="el" href="classmy__array.html" title="A basic array class. ">my_array</a>. The former holds just a chunk of data, the latter adds axes and additional functions. Once you have a class instance, i.e. a variable containing a thing of that class, you can call methods on it using the '.' Constructors are functions used to set up a new instance. For instance, if I want to make a 10x10 array, we set the parameters recording the dimension to define a 2-d array with sizes 10 and 10, and we grab some memory to store 10x10=100 data values etc. These special functions look like class_name(parameter list). We also have a destructor, which clean up when the variable is destroyed, and some special things which let us make copies, set one thing equal another and so on. These can be safely ignored. Quick example: </p><div class="fragment"><div class="line"><a class="code" href="classdata__array.html">data_array</a> dat = <a class="code" href="classdata__array.html">data_array</a>(10, 10); <span class="comment">//Make a new 10x10 array</span></div>
<div class="line">dat.<a class="code" href="classmy__array.html#a12808539e994856f5ef1f58a88197df1">set_element</a>(5, 5, 2.0); <span class="comment">//Set element 5, 5 to 2.0</span></div>
<div class="line"><a class="code" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> element = dat.<a class="code" href="classmy__array.html#a65cea2b7cdb86a5cd01595c51b88e1c9">get_element</a>(5, 5); <span class="comment">//element = 2.0 </span></div>
</div><!-- fragment --><h2><a class="anchor" id="default"></a>
Default arguments</h2>
<p>Function definitions can set default values for arguments which will be used if nothing is explicitly given. For example, </p><div class="fragment"><div class="line"> <span class="keywordtype">int</span> <a class="code" href="group__aux__fns.html#ga688546affff1ed798d263fe441129b68">add</a>(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b = 1){<span class="keywordflow">return</span> a+b;}</div>
<div class="line">cout&lt;&lt; <a class="code" href="group__aux__fns.html#ga688546affff1ed798d263fe441129b68">add</a>(1, 2)&lt;&lt;endl; <span class="comment">//Prints 3</span></div>
<div class="line">cout&lt;&lt; <a class="code" href="group__aux__fns.html#ga688546affff1ed798d263fe441129b68">add</a>(5)&lt;&lt;endl; <span class="comment">//Prints 6</span></div>
</div><!-- fragment --><p> With two arguments this prints their sum, but if only one if given, b is set to a value of 1.</p>
<h2><a class="anchor" id="pointer"></a>
Pointers * and -&gt;</h2>
<p>Some classes get rather large, for instance if they hold a lot of data internally. In this case, you might want to pass them about not by value (copying everything) but just by getting a pointer to where they are. Pointer variables are defined like class * my_pointer with an asterix. This variable holds only the address. Conversions between pointer and instance are: </p><div class="fragment"><div class="line"> <span class="keyword">class </span>* my_pointer = <span class="keyword">new</span> <span class="keyword">class</span>();</div>
<div class="line"><span class="keyword">class </span>my_instance = <span class="keyword">class</span>();</div>
<div class="line">my_instance = *(my_pointer); <span class="stringliteral">&#39;dereference&#39;</span> pointer to <span class="keyword">get</span> value it points to</div>
<div class="line">my_pointer = &amp;(my_instance); take <span class="stringliteral">&#39;address of&#39;</span> instance to <span class="keyword">get</span> pointer. </div>
</div><!-- fragment --><p> The special operator '-&gt;' is used to apply a method to a pointer: </p><div class="fragment"><div class="line"> my_instance.set_element(5, 5, 2.0);</div>
<div class="line">my_pointer-&gt;set_element(5, 5, 2.0);</div>
</div><!-- fragment --><p> Some of the core code uses these, none of the stuff in use should. The special id 'this' inside a class method refers to the instance the method was called on and is a pointer, so uses this-&gt; &amp; in a function means that you may pass an instance, but a copy will not be made, the function will just be given the address. For instance the function to read data into an array dat is</p><div class="fragment"><div class="line">my_reader.read_data(dat, time, space);</div>
</div><!-- fragment --><p> But a copy of dat is not made.</p>
<h2><a class="anchor" id="colon"></a>
The double colons ::</h2>
<p>The :: appears either with something like std:: or boost::math:: or with a class name, and means that this refers to the function X in that library, class etc (i.e. the function in the given namespace). So there might be a function abs() in the standard std library and in a math library and one must distinguish between them. Or both <a class="el" href="classmy__array.html" title="A basic array class. ">my_array</a> and <a class="el" href="classdata__array.html" title="Extended my_array class including axes. ">data_array</a> have a function called is_good() and the definitions must state which they refer to. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 6 2017 14:40:08 for WIPPS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
