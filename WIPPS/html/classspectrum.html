<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>WIPPS: spectrum Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="Doxy.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">WIPPS
   </div>
   <div id="projectbrief">Whistler-mode Interaction Post-Processing Suite</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classspectrum-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">spectrum Class Reference<div class="ingroups"><a class="el" href="group__cls.html">Main Classes</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A spectrum in omega and angle.  
 <a href="classspectrum.html#details">More...</a></p>

<p><code>#include &lt;spectrum.h&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:gafd492205351ae96d24bb69e1cafaca9f"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cls.html#gafd492205351ae96d24bb69e1cafaca9f">part</a> { <b>B</b>, 
<b>ang</b>
 }</td></tr>
<tr class="separator:gafd492205351ae96d24bb69e1cafaca9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4e405518424b3e9f3e605903feea65e5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a4e405518424b3e9f3e605903feea65e5">get_g_is_angle_only</a> ()</td></tr>
<tr class="separator:a4e405518424b3e9f3e605903feea65e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f5163d7d5d5a50074494c9076996dac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classspectrum.html">spectrum</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a1f5163d7d5d5a50074494c9076996dac">operator=</a> (const <a class="el" href="classspectrum.html">spectrum</a> &amp;src)</td></tr>
<tr class="separator:a1f5163d7d5d5a50074494c9076996dac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99dfa19aa8479db595d732ea95666826"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a99dfa19aa8479db595d732ea95666826">spectrum</a> (const <a class="el" href="classspectrum.html">spectrum</a> &amp;src)</td></tr>
<tr class="separator:a99dfa19aa8479db595d732ea95666826"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ef73291fa929780dc6457dd19bc19e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a67ef73291fa929780dc6457dd19bc19e">spectrum</a> (<a class="el" href="classspectrum.html">spectrum</a> &amp;&amp;src)=default</td></tr>
<tr class="separator:a67ef73291fa929780dc6457dd19bc19e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5005caf799c099e8f897c1d0e672f5d9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a5005caf799c099e8f897c1d0e672f5d9">~spectrum</a> ()</td></tr>
<tr class="separator:a5005caf799c099e8f897c1d0e672f5d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0784af832d813348e4152061652b5975"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a0784af832d813348e4152061652b5975">operator==</a> (const <a class="el" href="classspectrum.html">spectrum</a> &amp;rhs) const </td></tr>
<tr class="separator:a0784af832d813348e4152061652b5975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab379ad6a9e26f7d1163bf5960e01e9f4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#ab379ad6a9e26f7d1163bf5960e01e9f4">operator!=</a> (const <a class="el" href="classspectrum.html">spectrum</a> &amp;rhs) const </td></tr>
<tr class="separator:ab379ad6a9e26f7d1163bf5960e01e9f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75914781f41a55135b9dbba779e06020"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a75914781f41a55135b9dbba779e06020">is_good</a> () const </td></tr>
<tr class="separator:a75914781f41a55135b9dbba779e06020"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13d9acfb2b993665de03d31c65184616"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a13d9acfb2b993665de03d31c65184616">generate_spectrum</a> (<a class="el" href="classdata__array.html">data_array</a> &amp;parent, int om_fuzz, int angle_type, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> std_dev, <a class="el" href="classdata__array.html">data_array</a> *mask=nullptr)</td></tr>
<tr class="separator:a13d9acfb2b993665de03d31c65184616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e3835561c583d07074c08b86272e3b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a3e3835561c583d07074c08b86272e3b6">set_ids</a> (float time1, float time2, int space1, int space2, int <a class="el" href="classspectrum.html#a92cf0f2c50af2fad40beaac6018103de">wave_id</a>, char <a class="el" href="classspectrum.html#a9c1fcbe7b6a44f73c6cc9f17fdd2515e">block_id</a>[10], int function_type=<a class="el" href="group__const.html#ga518db694e7101247d80fee2079e31868">FUNCTION_DELTA</a>)</td></tr>
<tr class="separator:a3e3835561c583d07074c08b86272e3b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a162d87893808df5b1521a6a3bf149052"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a162d87893808df5b1521a6a3bf149052">set_extra_ids</a> (int <a class="el" href="classspectrum.html#a92cf0f2c50af2fad40beaac6018103de">wave_id</a>, int function_type=<a class="el" href="group__const.html#ga518db694e7101247d80fee2079e31868">FUNCTION_DELTA</a>)</td></tr>
<tr class="separator:a162d87893808df5b1521a6a3bf149052"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a873805463095435b1164925edc92759d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a873805463095435b1164925edc92759d">copy_ids</a> (const <a class="el" href="classdata__array.html">data_array</a> &amp;src)</td></tr>
<tr class="separator:a873805463095435b1164925edc92759d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0006ab24fa697f9c2fda2065d52ca72"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#ae0006ab24fa697f9c2fda2065d52ca72">check_ids</a> (const <a class="el" href="classdata__array.html">data_array</a> &amp;src) const </td></tr>
<tr class="separator:ae0006ab24fa697f9c2fda2065d52ca72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a638dbb6698a4fbcd6ce502ca491cbcd3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a638dbb6698a4fbcd6ce502ca491cbcd3">copy_tags</a> (const <a class="el" href="classspectrum.html">spectrum</a> &amp;src)</td></tr>
<tr class="separator:a638dbb6698a4fbcd6ce502ca491cbcd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad246d99441655930ad87ac8d99c07f65"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#ad246d99441655930ad87ac8d99c07f65">check_tags</a> (const <a class="el" href="classspectrum.html">spectrum</a> &amp;src) const </td></tr>
<tr class="separator:ad246d99441655930ad87ac8d99c07f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdcaf1780fd14ede6b50bf563f212a52"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#acdcaf1780fd14ede6b50bf563f212a52">get_omega</a> (<a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> k, int wave_type, bool deriv=0, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> theta=0.0)</td></tr>
<tr class="separator:acdcaf1780fd14ede6b50bf563f212a52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ea9cfdb9632bb1ec26cd90b0b095006"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a7ea9cfdb9632bb1ec26cd90b0b095006">get_k</a> (<a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> omega, int wave_type, bool deriv=0, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> theta=0.0)</td></tr>
<tr class="separator:a7ea9cfdb9632bb1ec26cd90b0b095006"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fc3178dfedc53bfb370445427e8ae9b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a3fc3178dfedc53bfb370445427e8ae9b">smooth_B</a> (int n_pts)</td></tr>
<tr class="separator:a3fc3178dfedc53bfb370445427e8ae9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab711bdcdf5c1bd31f708f283cc9fdbb6"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#ab711bdcdf5c1bd31f708f283cc9fdbb6">truncate_om</a> (<a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> om_min, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> om_max)</td></tr>
<tr class="separator:ab711bdcdf5c1bd31f708f283cc9fdbb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47df04c71657e4d92ff257210fb86059"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a47df04c71657e4d92ff257210fb86059">truncate_x</a> (<a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> x_min, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> x_max)</td></tr>
<tr class="separator:a47df04c71657e4d92ff257210fb86059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae664dc1aee32114d2efb56b7df5cd7e2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#ae664dc1aee32114d2efb56b7df5cd7e2">check_upper</a> ()</td></tr>
<tr class="separator:ae664dc1aee32114d2efb56b7df5cd7e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac3852af89853f295553d60e7d34594d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#aac3852af89853f295553d60e7d34594d">get_peak_omega</a> ()</td></tr>
<tr class="separator:aac3852af89853f295553d60e7d34594d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab89056c15b1b5f3fafd379430936f1dc"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#ab89056c15b1b5f3fafd379430936f1dc">calc_norm_B</a> ()</td></tr>
<tr class="separator:ab89056c15b1b5f3fafd379430936f1dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cf69a012a25240a586f7b82aa3c3242"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a4cf69a012a25240a586f7b82aa3c3242">calc_norm_g</a> (size_t om_ind)</td></tr>
<tr class="separator:a4cf69a012a25240a586f7b82aa3c3242"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acada14997ad0c1fe172288950a87d53c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#acada14997ad0c1fe172288950a87d53c">get_norm_B</a> ()</td></tr>
<tr class="separator:acada14997ad0c1fe172288950a87d53c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a436ca08ab68474b61d07b5d676b3380c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a436ca08ab68474b61d07b5d676b3380c">get_norm_g</a> (size_t om_ind)</td></tr>
<tr class="separator:a436ca08ab68474b61d07b5d676b3380c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8ac9a2dfd7b1c915c4e138ca3e0f045"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#ab8ac9a2dfd7b1c915c4e138ca3e0f045">apply</a> (<a class="el" href="group__cls.html#gafd492205351ae96d24bb69e1cafaca9f">spectrum::part</a> subarr, std::function&lt; <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>(<a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> arg)&gt; func)</td></tr>
<tr class="separator:ab8ac9a2dfd7b1c915c4e138ca3e0f045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d7f181a3fe61741ed77ab043c2aa05c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a6d7f181a3fe61741ed77ab043c2aa05c">apply</a> (<a class="el" href="group__cls.html#gafd492205351ae96d24bb69e1cafaca9f">spectrum::part</a> subarr, std::function&lt; <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>(<a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> arg, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> arg2)&gt; func, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> arg)</td></tr>
<tr class="separator:a6d7f181a3fe61741ed77ab043c2aa05c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f1397c68a29115b20b1aac744b465e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a3f1397c68a29115b20b1aac744b465e8">renormalise</a> ()</td></tr>
<tr class="memdesc:a3f1397c68a29115b20b1aac744b465e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Re-do normalising of spectrum.  <a href="#a3f1397c68a29115b20b1aac744b465e8">More...</a><br /></td></tr>
<tr class="separator:a3f1397c68a29115b20b1aac744b465e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87e5655db7b6eb5d7d95f9f47c9eb80b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a87e5655db7b6eb5d7d95f9f47c9eb80b">write_to_file</a> (std::fstream &amp;file)</td></tr>
<tr class="separator:a87e5655db7b6eb5d7d95f9f47c9eb80b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefb0d36e05477caf775e82ab7042054c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#aefb0d36e05477caf775e82ab7042054c">read_from_file</a> (std::fstream &amp;file)</td></tr>
<tr class="separator:aefb0d36e05477caf775e82ab7042054c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef1e39844c3f17b143976baee6d81f7f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdata__array.html">data_array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#aef1e39844c3f17b143976baee6d81f7f">copy_out_B</a> ()</td></tr>
<tr class="separator:aef1e39844c3f17b143976baee6d81f7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af69dbb49c5cf6e5700c4676b0ebdd1f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdata__array.html">data_array</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#af69dbb49c5cf6e5700c4676b0ebdd1f9">copy_out_g</a> ()</td></tr>
<tr class="separator:af69dbb49c5cf6e5700c4676b0ebdd1f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6af9c3076ce8212ac5cf3bacdca4bf8a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#ga6af9c3076ce8212ac5cf3bacdca4bf8a">get_B_element</a> (size_t n_om) const </td></tr>
<tr class="separator:ga6af9c3076ce8212ac5cf3bacdca4bf8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacac016090ac42d512b198d4f3bcb7b9d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#gacac016090ac42d512b198d4f3bcb7b9d">get_g_element</a> (size_t n_ang) const </td></tr>
<tr class="separator:gacac016090ac42d512b198d4f3bcb7b9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga675af58bb23ac8831e19d85f3ee8bb37"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#ga675af58bb23ac8831e19d85f3ee8bb37">get_g_element</a> (size_t n_om, size_t n_ang) const </td></tr>
<tr class="separator:ga675af58bb23ac8831e19d85f3ee8bb37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e736f31959430cbef0a6b2a01e36161"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#ga9e736f31959430cbef0a6b2a01e36161">set_B_element</a> (size_t n_om, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> val)</td></tr>
<tr class="separator:ga9e736f31959430cbef0a6b2a01e36161"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaca5a1984d6f7b4ec3eb22f002d8ca9aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#gaca5a1984d6f7b4ec3eb22f002d8ca9aa">set_g_element</a> (size_t n_ang, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> val)</td></tr>
<tr class="separator:gaca5a1984d6f7b4ec3eb22f002d8ca9aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5517841315e9fa269bd6cebd38a1bb72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#ga5517841315e9fa269bd6cebd38a1bb72">set_g_element</a> (size_t n_om, size_t n_ang, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> val)</td></tr>
<tr class="separator:ga5517841315e9fa269bd6cebd38a1bb72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf3fa818dc68ed509e5493363e2642018"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#gaf3fa818dc68ed509e5493363e2642018">get_om_axis_element</a> (size_t nx) const </td></tr>
<tr class="separator:gaf3fa818dc68ed509e5493363e2642018"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7895ab5f6a72738e8613c73abc0f683d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#ga7895ab5f6a72738e8613c73abc0f683d">get_ang_axis_element</a> (size_t nx) const </td></tr>
<tr class="separator:ga7895ab5f6a72738e8613c73abc0f683d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4bed1be8b464e2d4c4ec2499db692676"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#ga4bed1be8b464e2d4c4ec2499db692676">get_om_axis_index_from_value</a> (<a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> omega) const </td></tr>
<tr class="separator:ga4bed1be8b464e2d4c4ec2499db692676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadebf7f3cbba06c7af635093fbaca6783"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#gadebf7f3cbba06c7af635093fbaca6783">get_ang_axis_index_from_value</a> (<a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> ang) const </td></tr>
<tr class="separator:gadebf7f3cbba06c7af635093fbaca6783"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga571ce3e89dd29a1ffda04e7252494883"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#ga571ce3e89dd29a1ffda04e7252494883">set_om_axis_element</a> (size_t nx, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> val)</td></tr>
<tr class="separator:ga571ce3e89dd29a1ffda04e7252494883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae90b8f2da8dc820ca333324cd6085ff4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#gae90b8f2da8dc820ca333324cd6085ff4">set_ang_axis_element</a> (size_t nx, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> val)</td></tr>
<tr class="separator:gae90b8f2da8dc820ca333324cd6085ff4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad096e06d0912ab3b042d726209300197"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#gad096e06d0912ab3b042d726209300197">get_g_dims</a> () const </td></tr>
<tr class="separator:gad096e06d0912ab3b042d726209300197"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5bb69ec32b68051845aa15de48f0f11e"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#ga5bb69ec32b68051845aa15de48f0f11e">get_g_dims</a> (size_t i) const </td></tr>
<tr class="separator:ga5bb69ec32b68051845aa15de48f0f11e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac8fc683408378cf1e8f769026071e0ac"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#gac8fc683408378cf1e8f769026071e0ac">get_B_dims</a> () const </td></tr>
<tr class="separator:gac8fc683408378cf1e8f769026071e0ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1f21248e20e596ca417a706fbb96fa46"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#ga1f21248e20e596ca417a706fbb96fa46">get_B_dims</a> (size_t i) const </td></tr>
<tr class="separator:ga1f21248e20e596ca417a706fbb96fa46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae358e8d750ff498b22023207cf9221fa"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#gae358e8d750ff498b22023207cf9221fa">get_angle_length</a> () const </td></tr>
<tr class="separator:gae358e8d750ff498b22023207cf9221fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga495e5f5b91e2d5e35533ef53aa0be551"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__spect_acc.html#ga495e5f5b91e2d5e35533ef53aa0be551">get_omega_length</a> () const </td></tr>
<tr class="separator:ga495e5f5b91e2d5e35533ef53aa0be551"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a9c1fcbe7b6a44f73c6cc9f17fdd2515e"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a9c1fcbe7b6a44f73c6cc9f17fdd2515e">block_id</a> [<a class="el" href="group__const.html#gaa1a92c9b4b7de8220956b80d25b31723">ID_SIZE</a>]</td></tr>
<tr class="separator:a9c1fcbe7b6a44f73c6cc9f17fdd2515e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53ac97ca67dc3ac919faf94fcdbcadd5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a53ac97ca67dc3ac919faf94fcdbcadd5">time</a> [2]</td></tr>
<tr class="separator:a53ac97ca67dc3ac919faf94fcdbcadd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac77f1acf7ba7b246ce47c48281e7ab80"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#ac77f1acf7ba7b246ce47c48281e7ab80">space</a> [2]</td></tr>
<tr class="separator:ac77f1acf7ba7b246ce47c48281e7ab80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92cf0f2c50af2fad40beaac6018103de"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a92cf0f2c50af2fad40beaac6018103de">wave_id</a></td></tr>
<tr class="separator:a92cf0f2c50af2fad40beaac6018103de"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:a2da7e42f84f5b49f4acb40f35a15f91e"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classspectrum.html#a2da7e42f84f5b49f4acb40f35a15f91e">controller</a></td></tr>
<tr class="separator:a2da7e42f84f5b49f4acb40f35a15f91e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A spectrum in omega and angle. </p>
<p>Holds data on the omega and angle distributions. If fed an FFTd data array this will be X^2(omega, theta) where X is E or B. The latter can depend on omega! Can be created/destroyed only by controllers, so has no public constructor/destructors. IMPORTANT: because we are working with FFT data, we assume the angle/frequency axis either covers some small cutout in +ve domain, or is symmetrical in positive and negative values. A few of the specific routines here use this to simplify things. The sign of omega is simply copied from the sign of k. The "angle" axis is stored as tan(theta) for theta the wave normal angle. Access to elements should use the wrappers at the bottom of spectrum.h, described in <a class="el" href="group__spect_acc.html">Spectrum access wrappers</a> because internal layout could change in future. Note that prior to v1.1 the wave power was the TOTAL of the B^2 array, for v1.1 and later it is the INTEGRAL </p><dl class="section author"><dt>Author</dt><dd>Heather Ratcliffe </dd></dl>
<dl class="section date"><dt>Date</dt><dd>24/09/2015 </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a99dfa19aa8479db595d732ea95666826"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">spectrum::spectrum </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classspectrum.html">spectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy constructor</p>
<p>(Deep) copy src to a new instance. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Spectrum to copy from</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a67ef73291fa929780dc6457dd19bc19e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">spectrum::spectrum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classspectrum.html">spectrum</a> &amp;&amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Move a spectrum object </p>

</div>
</div>
<a class="anchor" id="a5005caf799c099e8f897c1d0e672f5d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">spectrum::~spectrum </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Delete spectrum</p>
<p>Free any allocated memory</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ab8ac9a2dfd7b1c915c4e138ca3e0f045"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spectrum::apply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cls.html#gafd492205351ae96d24bb69e1cafaca9f">spectrum::part</a>&#160;</td>
          <td class="paramname"><em>subarr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>(<a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> arg)&gt;&#160;</td>
          <td class="paramname"><em>func</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply a function to each element of selected spectrum part. func must take and return a my_type or type convertible to this </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subarr</td><td>Which part to apply to, see <a class="el" href="group__cls.html#gafd492205351ae96d24bb69e1cafaca9f">spectrum::part</a> </td></tr>
    <tr><td class="paramname">func</td><td>Function to apply</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6d7f181a3fe61741ed77ab043c2aa05c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spectrum::apply </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cls.html#gafd492205351ae96d24bb69e1cafaca9f">spectrum::part</a>&#160;</td>
          <td class="paramname"><em>subarr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>(<a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> arg, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> arg2)&gt;&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply a function to each element of selected spectrum part. func must take two my_type and return one my_type or type convertible to this </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">subarr</td><td>Which part to apply to, see <a class="el" href="group__cls.html#gafd492205351ae96d24bb69e1cafaca9f">spectrum::part</a> </td></tr>
    <tr><td class="paramname">func</td><td>Function to apply </td></tr>
    <tr><td class="paramname">arg</td><td>Second argument to function</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab89056c15b1b5f3fafd379430936f1dc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::calc_norm_B </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate norming of B(w)</p>
<p>Calculate the total square integral of values over range, int_{om_min}^{om_max} B^2(omega) d omega. </p><dl class="section return"><dt>Returns</dt><dd>0 (success), 1 (error)</dd></dl>

</div>
</div>
<a class="anchor" id="a4cf69a012a25240a586f7b82aa3c3242"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::calc_norm_g </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>om_ind</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Normalise g_w(x)</p>
<p>Calculate the norm of g used in e.g. denom of Albert <a class="el" href="citelist.html#CITEREF_Albert2005">[1]</a> Eq 3 or calc'd in Derivations.tex <a class="el" href="citelist.html#CITEREF_Derivations">[5]</a>. Contains one value for each omega entry. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">om_ind</td><td>Omega index to calculate norm at </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 (success), 1 (error e.g. out of range)</dd></dl>

</div>
</div>
<a class="anchor" id="ae0006ab24fa697f9c2fda2065d52ca72"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::check_ids </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classdata__array.html">data_array</a> &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check ids match</p>
<p>Checks ID fields match src. ID fields are the block_id, and the space and time values. See also <a class="el" href="classspectrum.html#ad246d99441655930ad87ac8d99c07f65">spectrum::check_tags()</a> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Array to check ids against </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if ids are equal, false else</dd></dl>

</div>
</div>
<a class="anchor" id="ad246d99441655930ad87ac8d99c07f65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::check_tags </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classspectrum.html">spectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check tags</p>
<p>Check tag fields match src. Tags are the g_is_angle_only, the function_type and the wave_id. See also <a class="el" href="classspectrum.html#ae0006ab24fa697f9c2fda2065d52ca72">spectrum::check_ids()</a> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Spectrum to compare tags against </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if equal, false else</dd></dl>

</div>
</div>
<a class="anchor" id="ae664dc1aee32114d2efb56b7df5cd7e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> spectrum::check_upper </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check upper k limit of spectral power</p>
<p>Checks the upper bound of region of significant spectral power, i.e. above SPECTRUM_THRESHOLD*peak_power </p><dl class="section return"><dt>Returns</dt><dd>The physical wavenumber where spectrum drops below threshold</dd></dl>

</div>
</div>
<a class="anchor" id="a873805463095435b1164925edc92759d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spectrum::copy_ids </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classdata__array.html">data_array</a> &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy id fields</p>
<p>Copies ID fields from src array to this. ID fields are the block_id, and the space and time values. These are attached to the spectrum AND to the B and g arrays it holds. See also <a class="el" href="classspectrum.html#a638dbb6698a4fbcd6ce502ca491cbcd3">spectrum::copy_tags()</a> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Array to copy ids from</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aef1e39844c3f17b143976baee6d81f7f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdata__array.html">data_array</a> spectrum::copy_out_B </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a copy of B array</p>
<p>Make a copy of the B part of data </p><dl class="section return"><dt>Returns</dt><dd>A data array containing a copy of the B data</dd></dl>

</div>
</div>
<a class="anchor" id="af69dbb49c5cf6e5700c4676b0ebdd1f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdata__array.html">data_array</a> spectrum::copy_out_g </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Return a copy of g array Make a copy of the g part of data </p><dl class="section return"><dt>Returns</dt><dd>A data array containing a copy of the g data</dd></dl>

</div>
</div>
<a class="anchor" id="a638dbb6698a4fbcd6ce502ca491cbcd3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spectrum::copy_tags </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classspectrum.html">spectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy tags</p>
<p>Copies tag fields from src array to this. Tags are the g_is_angle_only, the function_type and the wave_id. See also <a class="el" href="classspectrum.html#a873805463095435b1164925edc92759d">spectrum::copy_ids()</a> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Spectrum to copy tags from</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a13d9acfb2b993665de03d31c65184616"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::generate_spectrum </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classdata__array.html">data_array</a> &amp;&#160;</td>
          <td class="paramname"><em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>om_fuzz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>angle_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>std_dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdata__array.html">data_array</a> *&#160;</td>
          <td class="paramname"><em>mask</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate spectrum from data</p>
<p>Takes a parent data array and generates the corresponding spectrum. Windows using the specified wave dispersion and integrates over frequency using om_fuzz percent band. Axes are copied from the parent. If the spectrum is of separable type (g_is_angle_only = true), the angular distribution is generated with functional form specified by angle_type. IMPORTANT: when using real angular data we roughly fuzz around the correct k values, but this is not uniform! Non-smooth or rapidly varying data may give odd results </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parent</td><td>Data array to read from. Spectrum will have the same units as this </td></tr>
    <tr><td class="paramname">om_fuzz</td><td>Band width around dispersion curve in percent of central frequency </td></tr>
    <tr><td class="paramname">angle_type</td><td>Angular distribution functional form </td></tr>
    <tr><td class="paramname">std_dev</td><td>Standard deviation of angular functional form (where applicable) </td></tr>
    <tr><td class="paramname">mask</td><td>(optional) <a class="el" href="classdata__array.html" title="Extended my_array class including axes. ">data_array</a> matching sizes of parent, will be filled with the masking array used for spectrum generation. If nullptr or nothing is supplied, no mask is output. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 for successful calculation, 1 for error </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000018">Todo:</a></b></dt><dd>2-d and 3-d extractions don't quite agree at k=0. factor ~10 and variations near 0 </dd></dl>

</div>
</div>
<a class="anchor" id="a4e405518424b3e9f3e605903feea65e5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::get_g_is_angle_only </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get flag showing if spectrum is separable </p><dl class="section return"><dt>Returns</dt><dd>True if g is a function of only angle (and not frequency) false else </dd></dl>

</div>
</div>
<a class="anchor" id="a7ea9cfdb9632bb1ec26cd90b0b095006"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> spectrum::get_k </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>omega</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wave_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>deriv</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>theta</em> = <code>0.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets k for given omega</p>
<p>Uses dispersion relation for given wave_type to convert omega to k. Calls to plasma because approximations for density etc etc should be made there. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">omega</td><td>Frequency </td></tr>
    <tr><td class="paramname">wave_type</td><td>Wave species </td></tr>
    <tr><td class="paramname">deriv</td><td>Return v_g instead </td></tr>
    <tr><td class="paramname">theta</td><td>Wave normal angle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value of k for given omega and wave type etc</dd></dl>

</div>
</div>
<a class="anchor" id="acada14997ad0c1fe172288950a87d53c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> spectrum::get_norm_B </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the normalising constant for B part of spectrum </p><dl class="section return"><dt>Returns</dt><dd>Current value of norm_B </dd></dl>

</div>
</div>
<a class="anchor" id="a436ca08ab68474b61d07b5d676b3380c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> spectrum::get_norm_g </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>om_ind</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Get the normalising constant for g part of spectrum </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">om_ind</td><td>Frequency index to get from, 0 for separable spectra </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Current value of norm_g at specified location </dd></dl>

</div>
</div>
<a class="anchor" id="acdcaf1780fd14ede6b50bf563f212a52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> spectrum::get_omega </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wave_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>deriv</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>theta</em> = <code>0.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Gets omega for given k</p>
<p>Uses dispersion relation for given wave_type to convert k to omega. Calls to plasma because approximations for density etc etc should be made there. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>Wavenumber </td></tr>
    <tr><td class="paramname">wave_type</td><td>Wave species </td></tr>
    <tr><td class="paramname">deriv</td><td>Return v_g instead </td></tr>
    <tr><td class="paramname">theta</td><td>Wave normal angle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value of omega for given k and wave type etc</dd></dl>

</div>
</div>
<a class="anchor" id="aac3852af89853f295553d60e7d34594d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> spectrum::get_peak_omega </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find position of spectral peak</p>
<p>Finds location of highest peak in spectrum. </p><dl class="section return"><dt>Returns</dt><dd>The physical axis value where the spectral peak occurs</dd></dl>

</div>
</div>
<a class="anchor" id="a75914781f41a55135b9dbba779e06020"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::is_good </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Check if a spectrum is complete and useable </p><dl class="section return"><dt>Returns</dt><dd>Boolean true if good, false else </dd></dl>

</div>
</div>
<a class="anchor" id="ab379ad6a9e26f7d1163bf5960e01e9f4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::operator!= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classspectrum.html">spectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>See <a class="el" href="classspectrum.html#a0784af832d813348e4152061652b5975">spectrum::operator==()</a> </p>

</div>
</div>
<a class="anchor" id="a1f5163d7d5d5a50074494c9076996dac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classspectrum.html">spectrum</a> &amp; spectrum::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classspectrum.html">spectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>src</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Copy assignment</p>
<p>Sets this equal to a (deep) copy of source, i.e duplicates the B and g arrays and all other fields </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">src</td><td>Spectrum to copy from </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Copy of input spectrum</dd></dl>

</div>
</div>
<a class="anchor" id="a0784af832d813348e4152061652b5975"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::operator== </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classspectrum.html">spectrum</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Equality operator</p>
<p>Check this is equal to rhs. Since copies are always deep, we check values, not data pointers. We ignore the derived things such as smooth and norm_g </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rhs</td><td>Spectrum to compare to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>True if equal, false else</dd></dl>

</div>
</div>
<a class="anchor" id="aefb0d36e05477caf775e82ab7042054c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::read_from_file </td>
          <td>(</td>
          <td class="paramtype">std::fstream &amp;&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialise spectrum from file</p>
<p>Reads a dump file which is expected to contain two arrays, first B then g, as written by spectrum-&gt;write_to_file, and constructs spectrum from data </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>Filestream to read from </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 (success), 1 (error)</dd></dl>

</div>
</div>
<a class="anchor" id="a3f1397c68a29115b20b1aac744b465e8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void spectrum::renormalise </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Re-do normalising of spectrum. </p>
<p>Recalculate norm_B and norm_g and some other stored norm data </p>

</div>
</div>
<a class="anchor" id="a162d87893808df5b1521a6a3bf149052"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spectrum::set_extra_ids </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wave_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>function_type</em> = <code><a class="el" href="group__const.html#ga518db694e7101247d80fee2079e31868">FUNCTION_DELTA</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set id fields</p>
<p>Sets the wave type and angle type attached to spectra (i.e. the ids that can't be inherited from parent data) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wave_id</td><td>Wave type (see support.h) </td></tr>
    <tr><td class="paramname">function_type</td><td>Functional form of spectrum in angle</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3e3835561c583d07074c08b86272e3b6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spectrum::set_ids </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>time1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>time2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>space1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>space2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wave_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>block_id</em>[10], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>function_type</em> = <code><a class="el" href="group__const.html#ga518db694e7101247d80fee2079e31868">FUNCTION_DELTA</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set id fields</p>
<p>Sets the time and space ranges, wave type etc attached to this spectrum. Times should be in seconds. Space in terms of grid points. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">time1</td><td>Initial time of data used </td></tr>
    <tr><td class="paramname">time2</td><td>End time of data used </td></tr>
    <tr><td class="paramname">space1</td><td>Start index of space range of data used </td></tr>
    <tr><td class="paramname">space2</td><td>End index of space range of data used </td></tr>
    <tr><td class="paramname">wave_id</td><td>Wave type (see support.h) </td></tr>
    <tr><td class="paramname">block_id</td><td>Name of block used to derive this spectrum </td></tr>
    <tr><td class="paramname">function_type</td><td>Functional form of spectrum in angle</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3fc3178dfedc53bfb370445427e8ae9b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spectrum::smooth_B </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n_pts</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Smooth B</p>
<p>Apply a box-car smoothing to B with specified number of pts. Store n_pts in smooth field </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n_pts</td><td>Boxcar smoothing width to apply</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab711bdcdf5c1bd31f708f283cc9fdbb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::truncate_om </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>om_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>om_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Truncate omega distribution at om_min and om_max.</p>
<p>Zeros all elements outside the range [om_min, om_max]. Zeros are ignored. om_min must be &lt; om_max. Om_min or max out of axis range does nothing on that end. NB B is renormalised after the truncation </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">om_min</td><td>Minimum physical omega to truncate at </td></tr>
    <tr><td class="paramname">om_max</td><td>Maximum physical omega to truncate at </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 (success), 1 (range error)</dd></dl>

</div>
</div>
<a class="anchor" id="a47df04c71657e4d92ff257210fb86059"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::truncate_x </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>x_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>x_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Truncate angle distribution at x_min and x_max.</p>
<p>Zeros all elements outside the range [x_min, x_max]. x_min must be &lt; x_max. If x_min or max are out of range, nothing is done at that end </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x_min</td><td>Minimum tan theta to truncate at </td></tr>
    <tr><td class="paramname">x_max</td><td>Maximum tan theta to truncate at </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 (success), 1 (range error)</dd></dl>

</div>
</div>
<a class="anchor" id="a87e5655db7b6eb5d7d95f9f47c9eb80b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool spectrum::write_to_file </td>
          <td>(</td>
          <td class="paramtype">std::fstream &amp;&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write to file</p>
<p>Spectra are written by writing out the B array, the g array, and then writing a single closing footer containing the id values again. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>Filestream to write to </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 (success), 1 (error)</dd></dl>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a2da7e42f84f5b49f4acb40f35a15f91e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classcontroller.html">controller</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Controllers can create/destroy spectra and access their internals </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a9c1fcbe7b6a44f73c6cc9f17fdd2515e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char spectrum::block_id[<a class="el" href="group__const.html#gaa1a92c9b4b7de8220956b80d25b31723">ID_SIZE</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The field name id from SDF file </p>

</div>
</div>
<a class="anchor" id="ac77f1acf7ba7b246ce47c48281e7ab80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t spectrum::space[2]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Space range over which data are taken </p>

</div>
</div>
<a class="anchor" id="a53ac97ca67dc3ac919faf94fcdbcadd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> spectrum::time[2]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Time range over which data are taken </p>

</div>
</div>
<a class="anchor" id="a92cf0f2c50af2fad40beaac6018103de"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int spectrum::wave_id</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>ID for which wave mode cutout we're going for. See support.h </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 6 2017 14:40:07 for WIPPS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
