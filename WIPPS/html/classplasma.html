<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>WIPPS: plasma Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="Doxy.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">WIPPS
   </div>
   <div id="projectbrief">Whistler-mode Interaction Post-Processing Suite</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classplasma-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">plasma Class Reference<div class="ingroups"><a class="el" href="group__cls.html">Main Classes</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Plasma parameters and dispersion.  
 <a href="classplasma.html#details">More...</a></p>

<p><code>#include &lt;plasma.h&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:add494810b3de95604395b80c785cf0e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#add494810b3de95604395b80c785cf0e4">plasma</a> ()</td></tr>
<tr class="separator:add494810b3de95604395b80c785cf0e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ef21f7a3316c9507547245048fc0e5e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#a5ef21f7a3316c9507547245048fc0e5e">plasma</a> (std::string file_prefix, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> Bx_local=-1)</td></tr>
<tr class="separator:a5ef21f7a3316c9507547245048fc0e5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89f786093b3cf792dbf0a9805aa561d8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#a89f786093b3cf792dbf0a9805aa561d8">is_good</a> ()</td></tr>
<tr class="separator:a89f786093b3cf792dbf0a9805aa561d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb9d7e766639b4d61ce856e352386bc4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#aeb9d7e766639b4d61ce856e352386bc4">get_omega_ref</a> (std::string code) const </td></tr>
<tr class="separator:aeb9d7e766639b4d61ce856e352386bc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4ff8192ea45496560724fc123d12447"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#ae4ff8192ea45496560724fc123d12447">get_B0</a> ()</td></tr>
<tr class="separator:ae4ff8192ea45496560724fc123d12447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7883212811ee0e42b84b7bba33fd96bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#a7883212811ee0e42b84b7bba33fd96bb">set_B0</a> (<a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> B0)</td></tr>
<tr class="separator:a7883212811ee0e42b84b7bba33fd96bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afec3689e1016436f2bbc81055b5fb3b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmu__dmudom.html">mu_dmudom</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#afec3689e1016436f2bbc81055b5fb3b1">get_mu</a> (<a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> w, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> psi) const </td></tr>
<tr class="memdesc:afec3689e1016436f2bbc81055b5fb3b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve plasma dispersion only.  <a href="#afec3689e1016436f2bbc81055b5fb3b1">More...</a><br /></td></tr>
<tr class="separator:afec3689e1016436f2bbc81055b5fb3b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae660393eb45b85d1a597c9f8f4ff2bb0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmu__dmudom.html">mu_dmudom</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#ae660393eb45b85d1a597c9f8f4ff2bb0">get_high_dens_mu</a> (<a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> w, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> psi) const </td></tr>
<tr class="memdesc:ae660393eb45b85d1a597c9f8f4ff2bb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve plasma dispersion only.  <a href="#ae660393eb45b85d1a597c9f8f4ff2bb0">More...</a><br /></td></tr>
<tr class="separator:ae660393eb45b85d1a597c9f8f4ff2bb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb034bbfb5aca510acdebc23c8ce695c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmu__dmudom.html">mu_dmudom</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#aeb034bbfb5aca510acdebc23c8ce695c">get_phi_mu_om</a> (<a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> w, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> psi, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> alpha, int n, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> gamma_particle, bool skip_phi=false, bool Righthand=true) const </td></tr>
<tr class="separator:aeb034bbfb5aca510acdebc23c8ce695c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae03b6a534fe041f316ecb6babd8422f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmu__dmudom.html">mu_dmudom</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#ae03b6a534fe041f316ecb6babd8422f1">get_high_dens_phi_mu_om</a> (<a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> w, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> psi, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> alpha, int n, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> gamma_particle, bool skip_phi=false, bool Righthand=true) const </td></tr>
<tr class="separator:ae03b6a534fe041f316ecb6babd8422f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0aa62389da54ac6a04278c6711f935"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#aca0aa62389da54ac6a04278c6711f935">get_resonant_omega</a> (<a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> theta, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> v_par, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> gamma_particle, int n) const </td></tr>
<tr class="separator:aca0aa62389da54ac6a04278c6711f935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b9a685230330c2f0d6193a32f62569f"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#a7b9a685230330c2f0d6193a32f62569f">get_resonant_omega_full</a> (<a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> theta, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> v_par, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> gamma_particle, int n) const </td></tr>
<tr class="separator:a7b9a685230330c2f0d6193a32f62569f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac71ce3bd7c81e41c34fec904c5d681a6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac71ce3bd7c81e41c34fec904c5d681a6"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>check_resonant_omega</b> (<a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> theta, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> v_par, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> gamma_particle, int n, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> omega, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> &amp;result) const </td></tr>
<tr class="separator:ac71ce3bd7c81e41c34fec904c5d681a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2c13341aae1b6186bdfbfa8eb73dfde"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac2c13341aae1b6186bdfbfa8eb73dfde"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>check_resonant_omega_full</b> (<a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> theta, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> v_par, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> gamma_particle, int n, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> omega, <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> &amp;result) const </td></tr>
<tr class="separator:ac2c13341aae1b6186bdfbfa8eb73dfde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a901378127333ff9bc527a1eff3a565c8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classplasma.html#a901378127333ff9bc527a1eff3a565c8">get_dispersion</a> (<a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> k, int wave_type, bool reverse=0, bool deriv=0, <a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a> theta=0.0) const </td></tr>
<tr class="separator:a901378127333ff9bc527a1eff3a565c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Plasma parameters and dispersion. </p>
<p>Plasma objects contain specifications for a plasma, including density, B field, and species composition. In general we configure them from a file, plasma.conf, and no other constructor is provided. After construction, the plasma will be valid, but if given file is not found or reading fails, default values will be used. Two cyclotron frequencies are available, local and reference. For varying B fields, a reference B field should be given and the local om_ce will match this. The reference value always matches that in the <a class="el" href="structdeck__constants.html" title="Constants read from deck. ">deck_constants</a> struct. We offer functions to solve plasma dispersion "exactly" using the various get_root, get_phi* etc functions, or get_dispersion which uses various analytic approximations, usually high density ones. For the high-density approximations, the FIRST species is assumed to be the electrons. The former functions are modified from file mufunctions3.f90 author Clare E. J. Watt (18/05/10). From there: Note that mu is calculated using the Appleton-Hartree relation, and the choice of sign is obtained from Albert<a class="el" href="citelist.html#CITEREF_Albert2005">[1]</a>. An additional function to simultaneously solve the Doppler type resonance condition, and the approximate dispersion relation are provided. IMPORTANT: Plasma setup relies on my_consts being defined!! </p><dl class="section author"><dt>Author</dt><dd>Heather Ratcliffe </dd></dl>
<dl class="section date"><dt>Date</dt><dd>07/10/2015 </dd></dl>
<dl class="caveats"><dt><b><a class="el" href="caveats.html#_caveats000014">Caveat:</a></b></dt><dd>Note that no spatial variations in density or ambient B field are included in the dispersion calculations here</dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="add494810b3de95604395b80c785cf0e4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">plasma::plasma </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default constructor, create useless plasma object </p>

</div>
</div>
<a class="anchor" id="a5ef21f7a3316c9507547245048fc0e5e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">plasma::plasma </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>file_prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>Bx_local</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set up plasma</p>
<p>Sets up components from {file_prefix}plasma.conf. If a Bx_local is given, store and calc local cyclotron frequency from this. Else use the cyclotron frequency from deck constants. IMPORTANT: Make sure my_consts is defined (read_deck and share_consts) before creating plasma! </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file_prefix</td><td>File prefix prepended to all files read </td></tr>
    <tr><td class="paramname">Bx_local</td><td>Local x-component of magnetic field </td></tr>
  </table>
  </dd>
</dl>
<dl class="caveats"><dt><b><a class="el" href="caveats.html#_caveats000005">Caveat:</a></b></dt><dd>The ion frequencies assume a single ion species right now </dd></dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ae4ff8192ea45496560724fc123d12447"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> plasma::get_B0 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return B0. This can vary in space </p><dl class="section return"><dt>Returns</dt><dd>Value of B0 for this plasma </dd></dl>

</div>
</div>
<a class="anchor" id="a901378127333ff9bc527a1eff3a565c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> plasma::get_dispersion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wave_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>reverse</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>deriv</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>theta</em> = <code>0.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve analytic dispersion (approx)</p>
<p>By default returns omega for a given k (see reverse and deriv params param). Uses local reference cyclotron and plasma frequencies and works with UNNORMALISED quantitites. NB: parameters out of range will silently return 0. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>Wavenumber </td></tr>
    <tr><td class="paramname">wave_type</td><td>wave species (see support.h) </td></tr>
    <tr><td class="paramname">reverse</td><td>Return k for input omega </td></tr>
    <tr><td class="paramname">deriv</td><td>Whether to instead return anayltic v_g </td></tr>
    <tr><td class="paramname">theta</td><td>Wavenormal angle, default 0.0 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value of omega, or k if reverse is set </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000015">Todo:</a></b></dt><dd>Complete Xmode? </dd></dl>
<dl class="caveats"><dt><b><a class="el" href="caveats.html#_caveats000010">Caveat:</a></b></dt><dd>For Whistler modes this is an approximation and intended to be perfectly reversible. </dd></dl>

</div>
</div>
<a class="anchor" id="ae660393eb45b85d1a597c9f8f4ff2bb0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmu__dmudom.html">mu_dmudom</a> plasma::get_high_dens_mu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>psi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve plasma dispersion only. </p>
<p>Solve dispersion, omitting extended phi calcs, using high_dens approximation </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td>Wave frequency </td></tr>
    <tr><td class="paramname">psi</td><td>Wave normal angle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structmu__dmudom.html" title="Reduced refractive index. ">mu_dmudom</a> struct containing mu and derivs </dd></dl>

</div>
</div>
<a class="anchor" id="ae03b6a534fe041f316ecb6babd8422f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmu__dmudom.html">mu_dmudom</a> plasma::get_high_dens_phi_mu_om </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>gamma_particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>skip_phi</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>Righthand</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve plasma dispersion and extensions</p>
<p>Duplicates <a class="el" href="classplasma.html#aeb034bbfb5aca510acdebc23c8ce695c">plasma::get_phi_mu_om</a> but using reduced form of Stix parameters corresponding to a high-density assumption assuming the first species is the electrons. This is mainly for comparison with the exact solution to validate this assumption. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td>Wave frequency </td></tr>
    <tr><td class="paramname">psi</td><td>Wave normal angle </td></tr>
    <tr><td class="paramname">alpha</td><td>particle pitch angle (for phi) </td></tr>
    <tr><td class="paramname">n</td><td>Resonance number </td></tr>
    <tr><td class="paramname">gamma_particle</td><td>Relativistic gamma for resonant particle </td></tr>
    <tr><td class="paramname">skip_phi</td><td>Omit phi calculation </td></tr>
    <tr><td class="paramname">Righthand</td><td>True for Righthand wave mode, false for left </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structmu__dmudom.html" title="Reduced refractive index. ">mu_dmudom</a> object containing mu info </dd></dl>
<dl class="caveats"><dt><b><a class="el" href="caveats.html#_caveats000006">Caveat:</a></b></dt><dd>Unsurprisingly this routine uses a high density approximation to the dispersion, which assumes <img class="formulaInl" alt="$ \omega_{pe} >> \omega_{ce} $" src="form_2.png"/> </dd></dl>
<dl class="caveats"><dt><b><a class="el" href="caveats.html#_caveats000007">Caveat:</a></b></dt><dd>This routine assumes that electrons are the first species of the plasma, i.e. the first species in the plasma.conf file </dd></dl>

</div>
</div>
<a class="anchor" id="afec3689e1016436f2bbc81055b5fb3b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmu__dmudom.html">mu_dmudom</a> plasma::get_mu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>psi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Solve plasma dispersion only. </p>
<p>Solve dispersion, omitting extended phi calcs </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td>Wave frequency </td></tr>
    <tr><td class="paramname">psi</td><td>Wave normal angle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structmu__dmudom.html" title="Reduced refractive index. ">mu_dmudom</a> struct containing mu and derivs </dd></dl>

</div>
</div>
<a class="anchor" id="aeb9d7e766639b4d61ce856e352386bc4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> plasma::get_omega_ref </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>code</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reference plasma and cyclotron frequencies</p>
<p>Get value of omega at local position </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">code</td><td>two character code string. ce is actual Cyclotron freq. c0 is a reference value. pe is plasma frequency </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value of reference omega</dd></dl>

</div>
</div>
<a class="anchor" id="aeb034bbfb5aca510acdebc23c8ce695c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmu__dmudom.html">mu_dmudom</a> plasma::get_phi_mu_om </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>gamma_particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>skip_phi</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>Righthand</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve plasma dispersion and extensions</p>
<p>Solves Appleton-Hartree plasma dispersion and returns struct containing mu, its derivatives and error code. Also returns the Phi defined by Lyons <a class="el" href="citelist.html#CITEREF_Lyons1974B">[4]</a>. I.e. the set of values needed to calculate D See <a class="el" href="structmu__dmudom.html">mu_dmudom</a></p>
<p>Duplicated from mufunctions by CEJ Watt </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">w</td><td>Wave frequency </td></tr>
    <tr><td class="paramname">psi</td><td>Wave normal angle </td></tr>
    <tr><td class="paramname">alpha</td><td>particle pitch angle (for phi) </td></tr>
    <tr><td class="paramname">n</td><td>Resonance number </td></tr>
    <tr><td class="paramname">gamma_particle</td><td>Relativistic gamma for resonant particle </td></tr>
    <tr><td class="paramname">skip_phi</td><td>Omit phi calculation </td></tr>
    <tr><td class="paramname">Righthand</td><td>True for Righthand wave mode, false for left </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structmu__dmudom.html" title="Reduced refractive index. ">mu_dmudom</a> object containing mu info</dd></dl>
<p>On notation: within this routine we use notation as from mufunctions3.f90. In the return values as defined in support.h we match with Lyons <a class="el" href="citelist.html#CITEREF_Lyons1974B">[4]</a> and Albert <a class="el" href="citelist.html#CITEREF_Albert2005">[1]</a> . Thus in my_mu, we have lat, r, theta, omega for polar coordinate, r, wave normal angle and wave frequency</p>

</div>
</div>
<a class="anchor" id="aca0aa62389da54ac6a04278c6711f935"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> &gt; plasma::get_resonant_omega </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>v_par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>gamma_particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve plasma dispersion and doppler resonance simultaneously</p>
<p>Obtains solutions of the Doppler resonance condition omega - k_par v_par = -n Omega_ce and a high-density approximation to the Whistler mode dispersion relation simultaneously. Assumes pure electron-proton plasma and uses cubic_solve. ONLY solutions between -om_ce_local and om_ce_local, excluding omega = 0, are considered. "Zero" solutions are those less than the GEN_PRECISION constant in support.h.</p>
<p>Note that since k_parallel and v_parallel in resonant condition are signed, we will get multiple entries of ± omega for the corresponding ±k and ±n. These should be handled by the calling code, as k may or may not be handled with both signs </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">theta</td><td>Wave normal angle </td></tr>
    <tr><td class="paramname">v_par</td><td>Particle velocity to solve with </td></tr>
    <tr><td class="paramname">gamma_particle</td><td>Relativistic gamma for resonant particle </td></tr>
    <tr><td class="paramname">n</td><td>Resonance number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of solutions for resonant omega, or empty vector if no solutions are found </dd></dl>
<dl class="exts"><dt><b><a class="el" href="exts.html#_exts000001">Extension:</a></b></dt><dd>Extend this to use full solution rather than the high density approx </dd></dl>

</div>
</div>
<a class="anchor" id="a7b9a685230330c2f0d6193a32f62569f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a> &gt; plasma::get_resonant_omega_full </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>v_par</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#gad5403a5111c18f5f42fadde6157a5728">calc_type</a>&#160;</td>
          <td class="paramname"><em>gamma_particle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Solve plasma dispersion and doppler resonance simultaneously</p>
<p>Obtains solutions of the Doppler resonance condition omega - k_par v_par = -n Omega_ce and the Whistler mode dispersion relation simultaneously. Assumes pure electron-proton plasma and uses cubic_solve. ONLY solutions between -om_ce_local and om_ce_local, excluding omega = 0, are considered. "Zero" solutions are those less than the GEN_PRECISION constant in support.h.</p>
<p>Note that since k_parallel and v_parallel in resonant condition are signed, we will get multiple entries of ± omega for the corresponding ±k and ±n. These should be handled by the calling code, as k may or may not be handled with both signs </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">theta</td><td>Wave normal angle </td></tr>
    <tr><td class="paramname">v_par</td><td>Particle velocity to solve with </td></tr>
    <tr><td class="paramname">gamma_particle</td><td>Relativistic gamma for resonant particle </td></tr>
    <tr><td class="paramname">n</td><td>Resonance number </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of solutions for resonant omega, or empty vector if no solutions are found </dd></dl>
<dl class="caveats"><dt><b><a class="el" href="caveats.html#_caveats000008">Caveat:</a></b></dt><dd>I am assuming the solutions move but no more appear in the full equation. This may not be accurate, but we need a first guess for the solver </dd></dl>
<dl class="caveats"><dt><b><a class="el" href="caveats.html#_caveats000009">Caveat:</a></b></dt><dd>We set a hard minimum for resonant frequencies of interest, NR_min_om </dd></dl>

</div>
</div>
<a class="anchor" id="a89f786093b3cf792dbf0a9805aa561d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool plasma::is_good </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Whether everything is setup </p><dl class="section return"><dt>Returns</dt><dd>Boolean true is good, false else </dd></dl>

</div>
</div>
<a class="anchor" id="a7883212811ee0e42b84b7bba33fd96bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plasma::set_B0 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#ga0f3d3a6e2c07b43705a3b4c4060c9d5b">my_type</a>&#160;</td>
          <td class="paramname"><em>B0</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set B0</p>
<p>Sets the local reference B field value and thus om_ce_local value </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">B0</td><td>Input B0 value</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 6 2017 14:40:07 for WIPPS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
